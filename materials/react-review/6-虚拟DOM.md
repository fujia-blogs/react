# 虚拟 DOM

Q1：为什么需要虚拟 DOM？它有更好的性能吗？优势是什么？

什么是虚拟 DOM？ 本质上是 js 和 DOM 之间的一个映射缓存，在形态上表现为一个能够描述 DOM 结构及其属性信息的 js 对象。

Q2: react 使用虚拟 DOM，真的是为更好的性能吗？

- 在于 **研发效率/研发体验**

Q3：虚拟 DOM 的价值是什么？

> 从“虚拟 DOM 解决了哪些关键问题”的视角

- 研发体验/研发效率的问题

虚拟 DOM 的出现，为数据驱动视图这一思想提供了高度可用的载体，使得前端开发能够基于函数式 UI 的编程方式实现高效的声明式编程。

- 跨平台

一套虚拟 DOM，可以对接不同平台的渲染逻辑，从而实现“一次编码，多端运行”。

## 基础

1. V-DOM 工作流程：

- **挂载阶段**，react 将结合 jsx 的描述，构建出虚拟 DOM 树，然后通过 ReactDOM.render 实现虚拟 DOM 到真实 DOM 的映射(触发渲染流水线)。
- **更新阶段**，页面的变化在作用于真实 DOM 之前，会先作用于虚拟 DOM，虚拟 DOM 将在 JS 层借助算法先对比出具体有哪些真实 DOM 需要被改变，然后再将这些改变作用于真实 DOM。

2. 模板引擎实际的应用场景基本局限在“实现高效的字符串拼接”这一个点上，不能做太复杂的事情。

## 要点

1. 虚拟 DOM 和 redux 一样，不依附于任何具体的框架。

- https://github.com/Matt-Esch/virtual-dom

2. 虚拟 DOM 的好处是在提供好的研发体验和研发效率的同时，仍保持一个不错的性能。

3. 模板 VS. 虚拟 DOM

- 模板是差量更新
- 虚拟 DOM 是全量更新

虚拟 DOM 的劣势主要在于 JS 计算的耗时，DOM 操作的能耗和 js 计算的能耗根本不在一个量级。
