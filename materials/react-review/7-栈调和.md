# 栈调和(stack reconciler)

1. 不清楚 React 15 的运作机制，就无从把握它的局限性；如果我们不能确切地把握 React 15 的局限性，就无法从根本上理解 React 16 大改版背后的设计动机。因此在追逐时代潮流之前，必须学好历史。

## 调和(reconciliation)过程和 diff 算法

1. 调和(协调)：

Virtual DOM 是一种编程概念，UI 一种理想化的，或者说“虚拟的”表现形式被保存在内存汇总，并通过如 ReactDOM 等类库使之与“真实的”DOM 同步，这一个过程叫做协调。

2. diff 是调和过程中的一环。

### diff 策略的设计思想

1. React 团队结合设计层面的一些推导，总结了以下两个规律：

- 若两个组件属于同一个类型，那么它们将拥有相同的 DOM 树形结构；
- 处于同一层级的一组子节点，可用通过设置 key 作为唯一标识，从而维持各个节点在不同渲染过程中的稳定性。

2. diff 逻辑的要点：

- **分层对比**
- 类型一致的节点才有继续 diff 的必要性
- key 属性的设置，可以帮助尽可能重用同一层级内的节点。

`key 是用来帮助 React 识别哪些内容被更改、添加或者删除。key 需要写在用数组渲染出来的元素内部，并且需要赋予其一个稳定的值。稳定在这里很重要，因为如果 key 值发生了变更，React 则会触发 UI 的重渲染。这是一个非常有用的特性。`

## 要点

1. 学习知识需要建立必要且完整的上下文。

2. OJ 中相对理想的时间复杂度一般是 O(1)或 O(n)，当复杂度攀升至 O(n^2)时，就要考虑使用性能优化的手段了。
