# React Hooks 设计动机和工作模式

1. 面对一种(新)技术时，一种简单的的思路是 - 3W 方法：

- Why - 为什么需要它？
- What - 它是什么？
- How - 如何做？

`一般来说，了解了具体的“What”和“How”之后，往往能更加具象、清晰地回答理论层面“Why”的问题，对“Why”的探索和认知，也必然反哺到对“What”的理解和对“How”的实践。`

2. 函数组件/无状态组件(Function Component/Stateless Component)，以函数形式存在的 React 组件。

3. 函数组件 VS. 类组件

> 无关“优劣”，只谈不同

- 类组件需要继承 class，函数组件不需要
- 类组件可以访问生命周期方法，函数组件不能。
- 类组件中可以获取实例化后的 this，函数没有 this
- 类组件可以定义并维护 state，函数组件不可以。

## 问答

Q1：hooks 是如何帮助我们升级工作模式的？

函数组件相比类组件来说，有着不少能够利好 React 组件开发的特性，而 React-Hooks 的出现正是为了强化函数组件的能力。

Q2：为什么需要 react hooks？

- 告别难以理解的 Class；

this:

组件方法中获取不到 this，在 constructor 中使用 bind 绑定 this 或使用箭头函数来解决，**但是，它们本质上都是在用实践层面的约束来解决设计层面的问题**

生命周期：

- 解决业务逻辑难以拆分的问题；
- 使状态逻辑复用变得简单可行；

class 组件的复用状态逻辑，靠的是 HOC（高阶组件）和 Render Props 这些组件设计模式，这是因为 React 在原生层面并没有为我们提供相关的途径。但这些设计模式并非万能，它们在实现逻辑复用的同时，也破坏着组件的结构，其中一个最常见的问题就是“嵌套地狱”现象。

函数式组件中，可以通过自定义 hooks，达到既不破坏组件结构，又能实现逻辑复用的效果。

- 函数组件从设计思想上来看，更加契合 react 的理念。

Q3：hooks 如何实现更好的逻辑拆分？

- hooks 可以实现业务逻辑的聚合，避免复杂的组件和冗余的代码。

## 基础

### 重新理解类组件

1. 类组件是面向对象编程思想的一种表征，拥有这种意识后，我们往往会有意或无意做：

- 封装：将一类属性和方法，“聚拢”到一个 class 里去
- 继承：新的 class 可以通过继承现有 class 实现对某一类属性和方法的复用。

2. 对于解决许多问题来说，编写一个类组件实在是一个过于**复杂的姿势**，复杂的姿势必然带来高昂的理解成本。

### 函数式组件

1. 相比于类组件，函数组件的优点：

- 轻量
- 灵活
- 易于组织和维护
- 较低的学习成本
- **函数组件会捕获 render 内部的状态，这是两类组件最大的不同。**

2. 函数组件更加契合 react 框架的设计理念。

## hooks

1. Hooks 暂时还不能完全地为函数组件补齐类组件的能力：比如 getSnapshotBeforeUpdate、componentDidCatch 这些生命周期，目前都还是强依赖类组件的。

2. **hooks 在使用层面有着严格的约束。**

### useState() - 为函数组件引入状态

1. 同样逻辑的函数组件相比类组件而言，复杂度要低得多。

2. 在函数组件中调用 React.useState 的时候，实际上是给这个组件关联了**一个状态。**

### useEffect() - 用于为函数组件引入副作用的钩子

> 允许函数组件执行副作用操作，在某种程度上弥补了生命周期的缺席。

1. useEffect 回调中返回的函数被称为“清除函数”

- 这个规律不受第二个参数或其它因素的影响

## 要点

1. 对于一个工程师来说，Ta 对“Why”的执著程度，很大程度上能够反映其职业天花板的高度。

2. 在对比两种均被广泛使用的技术时，不应该有要评估出“孰优孰劣”这样的成见或目标，**重点应该关注在两者的不同上，**进而更准确地把它们不同的特征与同步的场景做连接。

3. 辩证的认知。

4. **类组件和函数组件之间的差异，纵有千差万别，但最不能够被忽视掉的，是心智模式层面的差异，**是面向对象和函数式编程这两套不同的设计思想之间的差异。

5. react 框架的主要工作，就是及时地**把声明式的代码转换为命令式的 DOM 操作，把数据层面的描述映射到用户可见的 UI 变化中去。**这意味着从原则上来说，**react 的数据应该总是紧紧地和渲染绑定在一起的，而类组件做不到这一点。**

6. 函数组件真正地把数据和渲染绑定到了一起。

7. 函数组件是一个更加匹配其设计理念，也更有利于逻辑拆分与重用的的组件表达形式。

8. hooks 的本质：**一套能够使函数组件更强大、更灵活的“钩子”。**

9. 有时候，我们必须学会忘记旧的知识，才能够更好地拥抱新的知识。

10. 世事无绝对，凡事有两面性。

11. “轻量”几乎是函数组件的基因，这可能使它不能够很好地消化“复杂”。
